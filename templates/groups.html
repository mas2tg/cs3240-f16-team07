{% extends 'base.html' %}

{% block content_block %}

<div class="text-center col-md-offset-3" style="position: absolute; z-index: 1000; left: 0; right: 0;"> <h3 style="display: inline; margin-top: 0;">Groups</h3> </div>
<button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#createGroupModal"><span class="glyphicon glyphicon-plus"></span> New group</button><br/><br/>

<div class="modal" id="createGroupModal" role="dialog" tabindex="-1" aria-labelledby="createGroup" aria-hidden="true">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			
			<form class="form" role="form" id="create_group_form" method="post" action="{% url 'users:create-group' %}">
			
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title">Create new group</h4>
			</div>

			<div class="modal-body">
				{% csrf_token %}
				<div class="form-group">
					<label for="recipient">Name:</label>
					<input class="form-control" type="text" name="group_name" value="" size="30" />
				</div>
			</div>

			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button class="btn btn-primary" type="submit" name="submit">Submit</button>
			</div>
				
			</form>

		</div>
	</div>
</div>



<ul class="nav nav-pills nav-stacked col-md-3">
<li class="active"><a data-toggle="pill" href="#my-groups">My groups</a></li>
{% if perms.users.site_manager %}<li><a data-toggle="pill" href="#other-groups">Other groups</a></li>{% endif %}
</ul>

<div class="tab-content col-md-9">
	<div id="my-groups" class="tab-pane fade in active">

		{% if user.groups.all %} <!-- User has groups -->
		<table data-toggle="table">
			<thead>
				<tr>
					<th data-sortable="true">Name</th>
					<th data-sortable="true"># of Members</th>
				</tr>
			</thead>
			<tbody data-link="row" class="rowlink">
				{% for group in user.groups.all|dictsort:'name' %}
					<tr>
						<td><a href="{% url 'group-summary' group_id=group.id %}"></a>{{ group.name }}</td>
						<td>{{ group.user_set.all|length }}</td>
					</tr>
		    	{% endfor %}
			</tbody>
		</table>
		{% else %}
		You are not in any groups.
		{% endif %}

	</div>

	{% if perms.users.site_manager %}
	<div id="other-groups" class="tab-pane fade">

		{% if other_groups %} <!-- User has groups -->
		<table data-toggle="table">
			<thead>
				<tr>
					<th data-sortable="true">Name</th>
					<th data-sortable="true"># of Members</th>
				</tr>
			</thead>
			<tbody data-link="row" class="rowlink">
				{% for group in other_groups|dictsort:'name' %}
					<tr>
						<td><a href="{% url 'group-summary' group_id=group.id %}"></a>{{ group.name }}</td>
						<td>{{ group.user_set.all|length }}</td>
					</tr>
		    	{% endfor %}
			</tbody>
		</table>
		{% else %}
		There are no other groups.
		{% endif %}

	</div>
	{% endif %}
</div>



{% endblock %}